<div class="relative">
  <div #searchContainer class="relative overflow-hidden rounded-lg p-[1px]">
    <div class="relative z-10">
      <input
        [formControl]="searchQuery"
        (focus)="onFocus()"
        (blur)="onBlur()"
        type="text"
        autocomplete="off"
        id="product_search"
        class="bg-gray-50 border transition-all border-gray-300 outline-none text-gray-900 text-sm rounded-lg ring-0 block w-full py-2.5 px-4 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"
        placeholder="Search products..."
        required
      />

      @if (searching()) {
      <i
        [ngClass]="highlightWidth() > 0 ? 'text-primary' : 'text-gray-400'"
        class="absolute top-1.5 right-4 lni lni-spinner-3 text-xl animate-spin"
      ></i>
      }@else {
      <i
        [ngClass]="highlightWidth() > 0 ? 'text-primary' : 'text-gray-400'"
        class="absolute top-1.5 right-4 lni lni-search-2 text-xl"
      ></i>
      }
    </div>
    <div
      class="z-0 bg-primary h-full duration-500 transition-all absolute top-0 left-1/2 -translate-x-1/2 rounded-lg"
      [style.width]="highlightWidth() + 'px'"
    >
      >
    </div>
  </div>

  @if (show_results()) {
  <div @resultsAnimation class="absolute top-14 left-0 w-full z-20">
    <ul class="bg-white border rounded-lg py-2">
      @for (product of results(); track $index) {
      <li
        (click)="onClick($event, product)"
        [routerLink]="['products', product.id, product.slug]"
        class="flex items-center space-x-4 p-4 hover:bg-indigo-50/50 cursor-pointer"
      >
        <img
          [src]="product.images[0].url"
          alt="Product Image"
          class="w-16 rounded-lg border"
        />
        <div class="flex-1">
          <p class="text-xs uppercase text-slate-400">
            {{ product.collection.name }}
          </p>
          <p
            class="text-lg font-light"
            [innerHTML]="product.name | highlight : searchQuery.value || ''"
          ></p>
        </div>
        <i class="lni lni-chevron-left rotate-180"></i>
      </li>
      @if( $index < results().length - 1) {
      <li class="mx-4 border-t"></li>
      } } @if(results().length === 0) {
      <li class="mx-4 text-sm p-2">
        {{ searching() ? "Searching..." : "No results to show" }}
      </li>
      }
    </ul>
  </div>
  }
</div>
